{% extends "base.html" %}
{% block title %}Edit Booking - Shumba Valeting{% endblock %}

{% block content %}

<h2 class= "edit-header">Edit Booking</h2>

<div id="edit-booking-messages">
    {% if messages %}
    {% for message in messages %}
        {% if "booking" in message.tags %}
            <div class="alert alert-{{ message.tags }}">
                {{ message }}
            </div>
        {% endif %}
    {% endfor %}
{% endif %}
</div>

<form method="post" id="edit-booking-form">
    {% csrf_token %}
    {{ form.as_p }}

    <span id="id_password_helptext" hidden></span>
    
    <button type="submit" class="btn btn-dark">Save Changes</button>
    <a href="{% url 'my_bookings' %}" class="btn btn-secondary">Back</a>
</form>


<script>
document.addEventListener("DOMContentLoaded", function () {
    // Detect Django field errors inside the form
    const fieldErrors = document.querySelector("#edit-booking-form .errorlist");

    // Detect Django flash messages
    const flashErrors = document.querySelector("#edit-booking-messages .alert");

    // If ANY kind of error exists â†’ scroll to edit form
    if (fieldErrors) {
        document.getElementById("edit-booking-form")
            .scrollIntoView({ behavior: "smooth", block: "start" });

        // Focus first offending field for better UX
        const invalidField = document.querySelector(
            "#edit-booking-form .errorlist + input, #edit-booking-form .errorlist + select"
        );
        if (invalidField) {
            invalidField.focus();
        }
    }
});
</script>

{% endblock %}